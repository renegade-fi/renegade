//! Defines constants for the Poseidon2 hash function over the BN254 scalar
//! field
//!
//! We use the same constants defined here:
//!     https://github.com/HorizenLabs/poseidon2/blob/main/plain_implementations/src/poseidon2/poseidon2_instance_bn256.rs

use ark_ec::Group;
use ark_ff::BigInt;
use constants::SystemCurveGroup as Curve;

/// The scalar field type that the hash function operates over
pub type ScalarField = <Curve as Group>::ScalarField;

/// The number of full rounds in the Poseidon permutation
pub const R_F: usize = 8;

/// The number of partial rounds in the Poseidon permutation
pub const R_P: usize = 56;

/// The width of the Poseidon permutation's code
pub const WIDTH: usize = 3;

/// The rate of the sponge construction layered on the permutation
pub const RATE: usize = 2;

/// The capacity of the sponge construction layered on the permutation
pub const CAPACITY: usize = 1;

/// The alpha constant used to parameterize the S-box in the Poseidon
/// permutation As per: https://eprint.iacr.org/2019/458.pdf this is the
/// smallest value alpha such that x^alpha is invertible in the scalar field,
/// equivalently gcd(alpha, p-1) = 1
pub const ALPHA: u64 = 5;

/// The round constants used in the full rounds of the Poseidon permutation
pub const FULL_ROUND_CONSTANTS: [[ScalarField; WIDTH]; R_F] = [
    [
        ScalarField::new(BigInt::new([
            6458331304642816022,
            9191791745966588794,
            10078444264992802031,
            2091475785534126077,
        ])),
        ScalarField::new(BigInt::new([
            13196537876657739280,
            13242552074285594254,
            12411648568120336672,
            3015986462747209158,
        ])),
        ScalarField::new(BigInt::new([
            11424359946556596689,
            2698455998639397967,
            2219105332273731329,
            2246365349865385472,
        ])),
    ],
    [
        ScalarField::new(BigInt::new([
            15782428245603856869,
            12762929946389366497,
            13652592920561494567,
            769322212625167858,
        ])),
        ScalarField::new(BigInt::new([
            656627337302130472,
            3963883011537030758,
            15489675571286521695,
            2473147239071445900,
        ])),
        ScalarField::new(BigInt::new([
            15321051510152419125,
            10502964042640599943,
            6513797472532144639,
            1883790224900438088,
        ])),
    ],
    [
        ScalarField::new(BigInt::new([
            5753026235266483322,
            738961277496629169,
            8934088858439642033,
            2520967471806658381,
        ])),
        ScalarField::new(BigInt::new([
            17282094170399272525,
            16580379156546658773,
            11299574250627272826,
            1178195396411754989,
        ])),
        ScalarField::new(BigInt::new([
            11843547806398251470,
            2387753460292841813,
            17734952367284543128,
            197758656190898648,
        ])),
    ],
    [
        ScalarField::new(BigInt::new([
            11673112823341286564,
            12369618416529278774,
            2844207100017432099,
            1065502144839691590,
        ])),
        ScalarField::new(BigInt::new([
            5258847900301915518,
            6505352688770326422,
            6071654207755516479,
            2967749481702258496,
        ])),
        ScalarField::new(BigInt::new([
            892821802737558910,
            14727071363237210694,
            2792543592443165093,
            2830937070444722279,
        ])),
    ],
    [
        ScalarField::new(BigInt::new([
            8705540160700578512,
            6746830576917213441,
            7092845282961761070,
            1931309519409552049,
        ])),
        ScalarField::new(BigInt::new([
            14595188708134663589,
            2015698889624141507,
            14187205567353648784,
            1871427985608321894,
        ])),
        ScalarField::new(BigInt::new([
            16271429997482961043,
            468818470830000426,
            7996775362779455505,
            2021487601170175912,
        ])),
    ],
    [
        ScalarField::new(BigInt::new([
            1733406684830268733,
            18152518321385677508,
            5836227034235395097,
            1491710151164857790,
        ])),
        ScalarField::new(BigInt::new([
            12660150021064259934,
            13267881929723736097,
            10315712918880346551,
            2108981438329286341,
        ])),
        ScalarField::new(BigInt::new([
            8525962534445484028,
            9934399915059914018,
            6988064890623532430,
            2207548493368319419,
        ])),
    ],
    [
        ScalarField::new(BigInt::new([
            1390870045172465649,
            6422021221791678552,
            13078062013033884631,
            322243138126305932,
        ])),
        ScalarField::new(BigInt::new([
            2080203751875985086,
            7362864967529529522,
            17728687880877874386,
            1812467639561021094,
        ])),
        ScalarField::new(BigInt::new([
            260056793786564966,
            12888488316328472437,
            14360227994345277611,
            1450833317726038835,
        ])),
    ],
    [
        ScalarField::new(BigInt::new([
            17947676061038389710,
            12834170303949236259,
            11384599308972499080,
            143388347964205391,
        ])),
        ScalarField::new(BigInt::new([
            6546071725730114135,
            12601887796104903258,
            8919969549330983706,
            1794029064565484592,
        ])),
        ScalarField::new(BigInt::new([
            1021565994830986662,
            10934776881971040877,
            12375328443065392690,
            1135395077632659701,
        ])),
    ],
];

/// The round constants used in the partial rounds of the Poseidon permutation
///
/// Note that this vector is not multidimensional; we only add a round constant
/// to the first element of the state in a partial round, see the Poseidon2
/// paper for more details
pub const PARTIAL_ROUND_CONSTANTS: [ScalarField; R_P] = [
    ScalarField::new(BigInt::new([
        5302271620417049781,
        14906098032514729777,
        13131960320030414264,
        1881667084089419620,
    ])),
    ScalarField::new(BigInt::new([
        13338254911895600183,
        586415510492166035,
        9483754624098305591,
        2786538975574068840,
    ])),
    ScalarField::new(BigInt::new([
        809569393612520424,
        528120150944813735,
        9342005836485684535,
        899704706212247635,
    ])),
    ScalarField::new(BigInt::new([
        17137185606063142037,
        13415865686895593136,
        11391838450430455070,
        2086742809232669367,
    ])),
    ScalarField::new(BigInt::new([
        8843393565329129737,
        1838180464329137089,
        6218527723244609675,
        1107386903008522679,
    ])),
    ScalarField::new(BigInt::new([
        4809630522644666222,
        17535228293073829195,
        10801336483130722817,
        1792268399693959384,
    ])),
    ScalarField::new(BigInt::new([
        5634636821807834076,
        15053876840384767471,
        7947578098813132826,
        357964892642556076,
    ])),
    ScalarField::new(BigInt::new([
        16527458989744188390,
        16677040905594745484,
        4341476110168786225,
        3010494594414878830,
    ])),
    ScalarField::new(BigInt::new([
        63306881032388373,
        7327841382898372030,
        13858532193471856477,
        1841200778148548229,
    ])),
    ScalarField::new(BigInt::new([
        5319782128374767476,
        12105534410073556125,
        7706728210739274202,
        2733165640907410782,
    ])),
    ScalarField::new(BigInt::new([
        13905011766727611265,
        397545458774684082,
        2618297833076747029,
        1409249416379998688,
    ])),
    ScalarField::new(BigInt::new([
        4617094559105111687,
        4793267458613048010,
        17791403032818154766,
        3486234691922257694,
    ])),
    ScalarField::new(BigInt::new([
        9674187949040268832,
        2439672703657190660,
        3127451649443712794,
        1877012939541750851,
    ])),
    ScalarField::new(BigInt::new([
        12273040699418823327,
        17004437659862682988,
        4609551378284273612,
        3118377810905829727,
    ])),
    ScalarField::new(BigInt::new([
        18106409021383810916,
        7005941813576523867,
        142065113101712121,
        1356675148274829111,
    ])),
    ScalarField::new(BigInt::new([
        13417219845588204063,
        18098831554155340941,
        8139412102635653279,
        2752703017946725000,
    ])),
    ScalarField::new(BigInt::new([
        9030911001104498125,
        17918615306737643293,
        777016847745710800,
        726472871956080806,
    ])),
    ScalarField::new(BigInt::new([
        15584670787591111609,
        2863790524049332765,
        1900103773593318106,
        2948408348452667051,
    ])),
    ScalarField::new(BigInt::new([
        16867895570996871532,
        9840099798364396799,
        680609925832583881,
        2047644432353969731,
    ])),
    ScalarField::new(BigInt::new([
        3617622047312850068,
        5723491105472485545,
        3108891270768987616,
        2290053041924610425,
    ])),
    ScalarField::new(BigInt::new([
        16635599629165910696,
        13889630767821251854,
        16393349863559499543,
        279513358749840108,
    ])),
    ScalarField::new(BigInt::new([
        4991402318615115981,
        5063502445310142847,
        7620324954341078828,
        3257591428770437702,
    ])),
    ScalarField::new(BigInt::new([
        15081224770952329547,
        5919227265182789027,
        17764430127524375836,
        669620769166038202,
    ])),
    ScalarField::new(BigInt::new([
        15360420589354587895,
        16261191412625806761,
        1854549200062090405,
        1833065620299829980,
    ])),
    ScalarField::new(BigInt::new([
        6975783924512399374,
        9737821894529518142,
        2291263480286660018,
        702362307909111359,
    ])),
    ScalarField::new(BigInt::new([
        6069171416060354126,
        3752469561037779032,
        5834479341906125444,
        1730499498393076028,
    ])),
    ScalarField::new(BigInt::new([
        15285076325592677980,
        13794437892125540525,
        3483915936988995384,
        1117085899585373406,
    ])),
    ScalarField::new(BigInt::new([
        9062361212365479288,
        12380341930130305002,
        15528130627563932004,
        1328247396736374211,
    ])),
    ScalarField::new(BigInt::new([
        17259757026730354065,
        1151600880302546424,
        7620006839548456097,
        2576626133210285583,
    ])),
    ScalarField::new(BigInt::new([
        8960531168600849300,
        4461975299424440180,
        17009261745893778992,
        3038488690496386825,
    ])),
    ScalarField::new(BigInt::new([
        13165667200848562987,
        14110818871887028667,
        5180761908053230572,
        555646921363871471,
    ])),
    ScalarField::new(BigInt::new([
        1381758840622748093,
        9986911534659916114,
        9826174633534139965,
        2824156456769809917,
    ])),
    ScalarField::new(BigInt::new([
        3413617401377599094,
        17258722595927485798,
        15605954241271186193,
        2115646988530496184,
    ])),
    ScalarField::new(BigInt::new([
        8945482950897992840,
        702592287789103350,
        3686043328539833836,
        3425852069776866095,
    ])),
    ScalarField::new(BigInt::new([
        7376743520743437269,
        2111267269708684676,
        15878419741432144411,
        2191075595829647030,
    ])),
    ScalarField::new(BigInt::new([
        2259619124330372427,
        12001441661304539563,
        6902370926577093337,
        1282945395516133573,
    ])),
    ScalarField::new(BigInt::new([
        16729565964201713852,
        6956698123409511863,
        3383169071491634900,
        2405817082479101412,
    ])),
    ScalarField::new(BigInt::new([
        5320921342946068874,
        2691715029914560996,
        10930922554022577632,
        1001529153797943229,
    ])),
    ScalarField::new(BigInt::new([
        11171553171900432536,
        15969234436173575856,
        16356721817558633473,
        3085620780208706067,
    ])),
    ScalarField::new(BigInt::new([
        15228643841329377399,
        4455358404709847991,
        7982463345877531625,
        2119812921062617820,
    ])),
    ScalarField::new(BigInt::new([
        14097760453325158398,
        856786123610740072,
        13335858100674396141,
        1612490154809976395,
    ])),
    ScalarField::new(BigInt::new([
        10854412943914486782,
        14892522000790554512,
        1247299884213565152,
        28614983888150324,
    ])),
    ScalarField::new(BigInt::new([
        14929667005143385101,
        3836713032172734107,
        8315888069836105516,
        2238834806901519768,
    ])),
    ScalarField::new(BigInt::new([
        1227321958173010238,
        4310456818987391418,
        12986075078568625117,
        2763362288870467025,
    ])),
    ScalarField::new(BigInt::new([
        7441031895532537359,
        9599919680464559728,
        8931488460254525139,
        1654118242821888559,
    ])),
    ScalarField::new(BigInt::new([
        16259374832042614367,
        6237462359444241861,
        11048481482555464692,
        1927010586885088017,
    ])),
    ScalarField::new(BigInt::new([
        147832287409453657,
        11483538217836605698,
        15607570256914320247,
        1027503282893456593,
    ])),
    ScalarField::new(BigInt::new([
        12124132488385046214,
        31921346119029583,
        5274767504760454943,
        1043762827231794559,
    ])),
    ScalarField::new(BigInt::new([
        5509839628418401949,
        7018542083821702829,
        1594960980879474461,
        581703325927526154,
    ])),
    ScalarField::new(BigInt::new([
        3325744805996203348,
        7543499699481574044,
        13522420521837659136,
        2424535168622248373,
    ])),
    ScalarField::new(BigInt::new([
        8264568362009840078,
        13623416661050546942,
        12497801165521077958,
        140459674360179844,
    ])),
    ScalarField::new(BigInt::new([
        5605477589105515659,
        10084396541222391775,
        183568619191429726,
        797512561166172386,
    ])),
    ScalarField::new(BigInt::new([
        3774123395629030959,
        2881218385746366730,
        17361136136679132462,
        2033634766325428180,
    ])),
    ScalarField::new(BigInt::new([
        12812937017348375870,
        3412938269445494740,
        4781767212785234811,
        2056393341899272936,
    ])),
    ScalarField::new(BigInt::new([
        10048060944186642319,
        2426675488974593715,
        17785911234421064746,
        230367907622696299,
    ])),
    ScalarField::new(BigInt::new([
        6619695695594038473,
        5832859038197865707,
        7480173222580839341,
        2774347868835657535,
    ])),
];
